{% extends 'base.html' %}

{% block content %}
<h1 class="mt-5 text-center">수강신청 검색</h1>

<p class="mt-5">
    <form method="get" action="{% url 'home' %}" class="mb-5">
        <table>
            <colgroup>
                <col width="45px">
                <col width="70px">
                <col width="75px">
                <col width="90px">
                <col width="50px">
                <col width="55px">
                <col width="75px">
                <col width="85px">
                <col width="75px">
                <col width="180px">
                <col width="75px">
                <col width="180px">
                <col width="75px">
                <col width="95pxs">
                <col width="80pxs">
            </colgroup>
            <tbody>
                <th>
                    캠퍼스
                </th>
                <td>
                    <select id="campus" name="campus" class="form-control">
                        <option value="">전체</option>
                        <option value="세종" {% if request.GET.campus == '세종' %}selected{% endif %}>세종</option>
                        <option value="서울" {% if request.GET.campus == '서울' %}selected{% endif %}>서울</option>
                    </select>
                </td>
                <th>
                    &nbsp&nbsp&nbsp&nbsp학수번호
                </th>
                <td>
                    <input type="text" class="form-control" id="course_number" name="course_number" placeholder="학수번호" value="{{ request.GET.course_number }}">
                </td>
                &nbsp
                <th>
                    &nbsp&nbsp&nbsp&nbsp분반
                </th>
                <td>
                    <input type="text" class="form-control" id="section" name="section" placeholder="분반" value="{{ request.GET.section }}">
                </td>
                <th>
                    &nbsp&nbsp&nbsp&nbsp이수구분
                </th>
                <td>
                    <select class="form-control" id="classification" name="classification">
                        <option value="">전체</option>
                        <option value="전공" {% if request.GET.classification == '전공' %}selected{% endif %}>전공</option>
                        <option value="교양" {% if request.GET.classification == '교양' %}selected{% endif %}>교양</option>
                    </select>
                </td>
                <th>
                    &nbsp&nbsp&nbsp&nbsp개설학과
                </th>
                <td>
                    <input type="text" class="form-control" id="department" name="department" placeholder="개설학과" value="{{ request.GET.department }}">
                </td>
                <th>
                    &nbsp&nbsp&nbsp&nbsp교과목명
                </th>
                <td>
                    <input type="text" class="form-control" id="course_name" name="course_name" placeholder="교과목명" value="{{ request.GET.course_name }}">
                </td>
                <th>
                    &nbsp&nbsp&nbsp&nbsp담당교수
                </th>
                <td>
                    <input type="text" class="form-control" id="professor" name="professor" placeholder="담당교수" value="{{ request.GET.professor }}">
                </td>
                <td>
                    &nbsp&nbsp&nbsp&nbsp<button type="submit" class="btn btn-primary">검색</button>
                </td>
            </tbody>
        </table>
        
    </form>
    
</p>

<table class="table table-hover table-bordered" id="courseTable">
    <thead>
        <th>캠퍼스</th>
        <th>학수번호</th>
        <th>분반</th>
        <th>이수구분</th>
        <th>개설학과</th>
        <th>교과목명</th>
        <th>담당교수</th>
    </thead>
    
    <tbody>
        {% for course in courses %}
            <tr data-href="{% url 'detail' course.id %}">
                <td>{{course.campus}}</td>
                <td>{{course.courseid}}</td>
                <td>{{course.subid}}</td>
                <td>{{course.division}}</td>
                <td>{{course.department|linebreaksbr}}</td>
                <td>{{course.coursename|linebreaksbr}}</td>
                <td>{{course.professor}}</td>
            </tr> 
        {% endfor %}
    </tbody>
    
</table>

<div class="mt-5 text-center">
    <ul class="pagination justify-content-center">
        <!-- 이전페이지 -->
        {% if courses.has_previous %}
        <li class="page-item">
            <a class="page-link" href="?page={{ courses.previous_page_number }}">이전</a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link" tabindex="-1" aria-disabled="true" href="#">이전</a>
        </li>
        {% endif %}
        <!-- 페이지리스트 -->
        {% for page_number in paginator.page_range %}
        {% if page_number >= courses.number|add:-5 and page_number <= courses.number|add:5 %}
        {% if page_number == courses.number %}
        <li class="page-item active" aria-current="page">
            <a class="page-link" href="?page={{ page_number }}{% if request.GET.campus %}&campus={{ request.GET.campus }}{% endif %}{% if request.GET.course_number %}&course_number={{ request.GET.course_number }}{% endif %}{% if request.GET.section %}&section={{ request.GET.section }}{% endif %}{% if request.GET.classification %}&classification={{ request.GET.classification }}{% endif %}{% if request.GET.department %}&department={{ request.GET.department }}{% endif %}{% if request.GET.course_name %}&course_name={{ request.GET.course_name }}{% endif %}{% if request.GET.professor %}&professor={{ request.GET.professor }}{% endif %}">{{ page_number }}</a>
        </li>
        {% else %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_number }}{% if request.GET.campus %}&campus={{ request.GET.campus }}{% endif %}{% if request.GET.course_number %}&course_number={{ request.GET.course_number }}{% endif %}{% if request.GET.section %}&section={{ request.GET.section }}{% endif %}{% if request.GET.classification %}&classification={{ request.GET.classification }}{% endif %}{% if request.GET.department %}&department={{ request.GET.department }}{% endif %}{% if request.GET.course_name %}&course_name={{ request.GET.course_name }}{% endif %}{% if request.GET.professor %}&professor={{ request.GET.professor }}{% endif %}">{{ page_number }}</a>
        </li>
        {% endif %}
        {% endif %}
        {% endfor %}
        <!-- 다음페이지 -->
        {% if courses.has_next %}
        <li class="page-item">
            <a class="page-link" href="?page={{ courses.next_page_number }}">다음</a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link" tabindex="-1" aria-disabled="true" href="#">다음</a>
        </li>
        {% endif %}
    </ul>
</div>

{% endblock %}